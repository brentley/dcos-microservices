{
   "id":"demo",
   "apps":[
      {
         "id":"articleservice",
         "cpus":1,
         "mem":256,
         "ports":[
            0
         ],
         "instances":1,
         "container":{
            "type":"DOCKER",
            "docker":{
               "image":"unterstein/dcos-microservices-article:latest",
               "network":"BRIDGE",
               "forcePullImage": true,
               "portMappings":[
                  {
                     "hostPort":0,
                     "containerPort":8081,
                     "protocol":"tcp",
                     "labels":{
                        "VIP_0":"articleservice:8081"
                     }
                  }
               ]
            }
         },
         "upgradeStrategy":{
            "minimumHealthCapacity":0.85,
            "maximumOverCapacity":0.15
         },
         "healthChecks":[
            {
               "protocol":"HTTP",
               "path":"/articles/",
               "portIndex":0,
               "timeoutSeconds":10,
               "gracePeriodSeconds":10,
               "intervalSeconds":2,
               "maxConsecutiveFailures":10
            }
         ]
      },
      {
         "id":"basketservice",
         "cpus":1,
         "mem":256,
         "ports":[
            0
         ],
         "instances":1,
         "container":{
            "type":"DOCKER",
            "forcePullImage": true,
            "docker":{
               "image":"unterstein/dcos-microservices-basket:latest",
               "network":"BRIDGE",
               "portMappings":[
                  {
                     "hostPort":0,
                     "containerPort":8082,
                     "protocol":"tcp",
                     "labels":{
                        "VIP_0":"basketservice:8082"
                     }
                  }
               ]
            }
         },
         "upgradeStrategy":{
            "minimumHealthCapacity":0.85,
            "maximumOverCapacity":0.15
         },
         "healthChecks":[
            {
               "protocol":"HTTP",
               "path":"/basket/",
               "portIndex":0,
               "timeoutSeconds":10,
               "gracePeriodSeconds":10,
               "intervalSeconds":2,
               "maxConsecutiveFailures":10
            }
         ]
      },
      {
         "id":"checkoutservice",
         "dependencies":[
            "/demo/articleservice",
            "/demo/basketservice"
         ],
         "cpus":1,
         "mem":256,
         "ports":[
            0
         ],
         "instances":1,
         "container":{
            "type":"DOCKER",
            "docker":{
               "image":"unterstein/dcos-microservices-checkout:latest",
               "network":"BRIDGE",
               "forcePullImage": true,
               "portMappings":[
                  {
                     "hostPort":0,
                     "containerPort":8083,
                     "protocol":"tcp",
                     "labels":{
                        "VIP_0":"checkoutservice:8083"
                     }
                  }
               ]
            }
         },
         "upgradeStrategy":{
            "minimumHealthCapacity":0.85,
            "maximumOverCapacity":0.15
         },
         "healthChecks":[
            {
               "protocol":"HTTP",
               "path":"/checkout/health",
               "portIndex":0,
               "timeoutSeconds":10,
               "gracePeriodSeconds":10,
               "intervalSeconds":2,
               "maxConsecutiveFailures":10
            }
         ],
         "env":{
            "HOST_ARTICLESERVICE":"articleservice.marathon.l4lb.thisdcos.directory",
            "HOST_BASKETSERVICE":"basketservice.marathon.l4lb.thisdcos.directory"
         }
      },
      {
         "id":"webservice",
         "cpus":1,
         "mem":256,
         "ports":[
            0
         ],
         "instances":1,
         "container":{
            "type":"DOCKER",
            "docker":{
               "image":"unterstein/dcos-microservices-web:latest",
               "network":"BRIDGE",
               "forcePullImage": true,
               "portMappings":[
                  {
                     "hostPort":0,
                     "containerPort":80,
                     "protocol":"tcp",
                     "labels":{
                        "VIP_0":"webservice:80"
                     }
                  }
               ]
            }
         },
         "upgradeStrategy":{
            "minimumHealthCapacity":0.85,
            "maximumOverCapacity":0.15
         },
         "healthChecks":[
            {
               "protocol":"HTTP",
               "path":"/",
               "portIndex":0,
               "timeoutSeconds":10,
               "gracePeriodSeconds":10,
               "intervalSeconds":2,
               "maxConsecutiveFailures":10
            }
         ]
      },
      {
         "id":"proxy",
         "dependencies":[
            "/demo/articleservice",
            "/demo/basketservice",
            "/demo/checkoutservice",
            "/demo/webservice"
         ],
         "cpus":1,
         "mem":256,
         "ports":[
            0
         ],
         "instances":1,
         "container":{
            "type":"DOCKER",
            "docker":{
               "image":"unterstein/dcos-microservices-proxy:latest",
               "network":"BRIDGE",
               "forcePullImage": true,
               "portMappings":[
                  {
                     "hostPort":0,
                     "containerPort":80,
                     "protocol":"tcp"
                  }
               ]
            }
         },
         "labels":{
            "HAPROXY_0_VHOST":"your.public.elb.amazonaws.com",
            "HAPROXY_GROUP":"external"
         },
         "env":{
            "HOST_ARTICLESERVICE":"articleservice.marathon.l4lb.thisdcos.directory",
            "HOST_BASKETSERVICE":"basketservice.marathon.l4lb.thisdcos.directory",
            "HOST_CHECKOUTSERVICE":"checkoutservice.marathon.l4lb.thisdcos.directory",
            "HOST_WEBSERVICE":"webservice.marathon.l4lb.thisdcos.directory",
            "VERSION":"3"
         },
         "upgradeStrategy":{
            "minimumHealthCapacity":0.85,
            "maximumOverCapacity":0.15
         },
         "healthChecks":[
            {
               "protocol":"HTTP",
               "path":"/",
               "portIndex":0,
               "timeoutSeconds":10,
               "gracePeriodSeconds":10,
               "intervalSeconds":2,
               "maxConsecutiveFailures":10
            }
         ]
      }
   ]
}